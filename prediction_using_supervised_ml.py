# -*- coding: utf-8 -*-
"""prediction using supervised ml.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/12lgMmNiMMQzlpTp6AC9BSSzmXFw7dK7O
"""

# Commented out IPython magic to ensure Python compatibility.


# Importing all libraries required in this notebook
import pandas as pd
import numpy as np  
import matplotlib.pyplot as plt  
# %matplotlib inline

# Reading data from remote link
url = "http://bit.ly/w-data"
s_data = pd.read_csv(url)
print("Data imported successfully")

s_data.head(10)

s_data.info()

# Plotting the distribution of scores
s_data.plot(x='Hours', y='Scores', style='o')  
plt.title('Hours vs Percentage')  
plt.xlabel('Hours Studied')  
plt.ylabel('Percentage Score')  
plt.show()

x=s_data['Hours'].values
y=s_data['Scores'].values
x  = x.reshape(-1, 1)
y  = y.reshape(-1, 1)

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=0)

from sklearn.linear_model import LinearRegression
model=LinearRegression()
model.fit(x_train,y_train)

pred=model.predict(x_test)

from sklearn.metrics import accuracy_score,classification_report,confusion_matrix,r2_score,mean_absolute_error
print(r2_score(y_test,pred))
print('Mean Absolute Error:', mean_absolute_error(y_test, pred))

var=model.predict([[9.25]])
print("Score of the student will be:",round(var[0][0],2))

